\chapter{Динамическая идентификация систем}

Динамическая идентификация представляет собой процесс построения математических
моделей динамических систем на основе измерений их входных и выходных сигналов.
В динамической системе значения выходных сигналов зависят как от текущих
значений входных сигналов, так и от предшествующего поведения системы
\cite{bb:identification}. Типичные этапы динамической идентификации включают
следующие этапы: 

\begin{enumerate}
  \item Определение и выделение исследуемых параметров системы;
  \item Формирование набора данных о работе исследуемой системы;
  \item Выбор метода идентификации;
  \item Разработка модели
  \item Оценка параметров и валидация полученой модели.
\end{enumerate}

Основная задача динамической идентификации состоит в выявлении неявных
закономерностей между параметрами модели, которые бы наилучшим образом
описывали наблюдаемое поведение системы. Такая модель может быть использована
для прогнозирования поведения системы при изменении входных параметров или для
оптимизации работы установки. 

Раздел математического моделирования, специализирующего на динамической
идентификации имеет широкий инструментарий и большое количество методов
построения цифровых двойников \cite{bib:ident:autoregr}. В частности, 
все методы можно разделить на следующие большие группы:

\begin{itemize}
  \item Параметрические;
  \item Непараметрические;
  \item Гибридные.
\end{itemize}

Параметрические методы включают в себя методы, предполагающие наличие
информации о структуре исследуемой модели. Для данного класса методов задача
сводится к определению параметров соотношений, описывающих модели. Данный класс
методов требует серьезного методологического анализа и учет мельчайших
особенностей работы системы \cite{bib:ident:simulation}. Данный класс методов зачастую сложно применять в
ситуациях, где система имеет большое количество компонентов и подвержена
внешним воздействиям, однако такие модели имеют наибольшую точность и наиболее
широко обхватывают все процессы, которым подвержена моделируемая система.
Непараметрические методы, в отличии от параметрических,
не требуют априорного знания о структуре модели и основывается лишь на данных о
работе системы \cite{bib:ident:arrays}. Данный класс методов основывается на построении
аппроксимационных моделей системы для определенных режимов работы.
Непараметрические методы применяются для описания сложных комплексных систем
для которых не требуется точности, но нужно общее поведение системы. Гибридные
методы же сочетают в себе особенности параметрических и непараметрических. 

С широким развитием интеллектуальных моделей, в частности, основанных на базе
технологии нейронных сетей, классификацию методов можно разделить на
традиционные и интеллектуальные методы \cite{bib:ident:neural:modelling}.

Классические методы идентификации предполагают изучение и описание структуры
модели, линейность или слабые степени нелинейности системы. Однако в реальных
системах исследуемые объекты могут быть сложными, с неявной нелинейностью и
нелокальными эффектами, тем самым ограничивая возможности классических методов. 

\section{Традиционные методы}

Традиционные методы являются подразделом математического моделирования и
описывают методы, основная идея которых заключается в выборе предопределенной
структуры модели и последующей оценке
параметров этой структуры таким образом, чтобы минимизировать разницу между
выходом реальной системы и выходом модели для одних и тех же входных данных.
В качестве структуры модели может выступать, например передаточная функция,
модель пространства состояний, ARX-модель \Abbrev{ARX}{Auto Regressive with
eXogenous input ""--- модели авторегрессии с экзогенными переменными}. 

Основная задача при использовании классических методов заключается в правильном
выборе модели и её размерности, в соответствии с этим данные методы делятся на
линейные и нелинейные.

\subsection{Линейные методы}

Подкласс линейных методов во многом основан на идее решения систем
алгебраических уравнений или их линейных комбинациях. 

Эти методы ориентированы на идентификацию моделей, описывающих линейные
динамические системы или линейную часть комплексных систем \cite{bib:ident:linear}. 
Даже при наличии нелинейности, эти методы пытаются найти наилучшую линейную 
аппроксимацию или применимы после линеаризации системы. К данным методам относятся 
следующие:
\begin{itemize}
  \item Метод наименьших квадратов;
  \item Метод миинимизации ошибки предсказания \Abbrev{PEM}{Prediction Error
    Methods ""--- Методы предсказания ошибки};
  \item Подпространственный SIM\Abbrev{SIM}{Subspace Identification Methods
    ""--- Подпространственные методы идентификации} метод;
  \item Частотные методы.
\end{itemize}

\subsubsection{Метод наименьших квадратов}

Данный метод является одним из самых простых и широко используемых методов. Основная
идея метода заключается в нахождении параметров модели, при которых сумму
квадратов разностей между измеренными выходами системы и выходами модели
(ошибок) принимала бы минимальное значение.

Метод наименьших квадратов чаще всего применяется для идентификации с
использованием моделей типа ARX. Модель ARX линейна по своим параметрам и
может быть описана линейной комбинацией входных и выходных сигналов:

\begin{equation}
  y(t)+a_1y(t-1)+\dots+a_{n_a}y(t-n_a)=b_0u(t-n_k)+\dots+b_{n_b}u(t-n_b-n_k)+e(t)
  \label{eq:arx}
\end{equation}

В данном выражении $ y(t) $ - выходной сигнал,  $u(t)$ - вход, $e(t)$ - ошибка (шум), $a_i$ ,$b_i$ - параметры, $n_a$,$n_b$ - порядки полиномов, $n_k$ - задержка.

В матричной форме задача сводится к решению

\begin{equation}
  \Phi\Theta \approx Y
  \label{eq:mnk}
\end{equation}

Для выражения \ref{eq:mnk} введены следующие обозначения: $\Theta$ - вектор
параметров, $Y$ - вектор выходных данных, а $\Phi$ - матрица, содержащая
прошлые значения входа и выхода.

Для линейных по параметрам моделей, таких как ARX, решение может быть найдено
аналитически (см. выражение ниже) \cite{bib:arx}.

\begin{equation}
  \hat{\Theta} = (\Theta^T \Theta)^{-1} \Phi^T Y
  \label{eq:mnk_arx_sol}
\end{equation}

Несмотря на наличие аналоитического решения,
метод имеет сильную чувствительность к шуму,
в частности если шум коррелирован или влияет
на входные переменные. МНК дает смещенные
оценки параметров в этих случаях. В связи с
этим он ограничен применением в основном к
линейным по параметрам моделям.

\subsubsection{PEM-метод}

PEM представляют собой метод, аналогичный по идее методу наименьших квадратов,
за исключением вида целевой функции. Данному методу характерно понятие
предиктора модели, под которым понимается модель, использующая доступные
прошлые данные о работе реальной системы для наилучшего предсказания следующего
выходного значения \cite{bib:ident:neural:SVD}. Целью метода является минимизация ошибки моделирования, а
именно разницы между измеренным выходом и выходом предиктора модели. 

Оценка параметров в PEM обычно требует итерационных численных методов
оптимизации (например, градиентного спуска, метода Ньютона и др.), поскольку
функция ошибки предсказания является нелинейной функцией параметров для
большинства моделей. 

Благодаря своим особенностям данный метод статистически эффективнее и применим
к более широкому классу линейных моделей, чем простой МНК. Кроме того, данный
метод может работать с более сложными моделями шума.

Однако, в связи со своей итерационной природой метод сильно чувствителен к
начальным приближениям и имеет проблему пропуска решения в локальных минимумах,
нежели в глобальных. Также он требует итерационной оптимизации и необходимости
подбора корректной модели шума.

\subsubsection{SIM-метод}

SIM методы основаны на построении модели систем с использованием пространств состояний. Фомрально же, процесс идентификации можно описать с помощью системы линейных уравнений (см. ниже). 

\begin{equation}
  \begin{array}{rcl}
    x(t+1) & = &Ax(t)+Bu(t)+\omega(t) \\
    y(t) &= & Cx(t)+Du(t)+v(t) \\
  \end{array}
    \label{eq:sim_ss}
\end{equation}

В данном выражении $ y(t) $ - выходной сигнал,  $u(t)$ - вход, $\omega(t)$ -
шум процесса, $v(t)$ - шум измерения, $A$ ,$B$ $C$ $D$ - матрицы описания
системы.

SIM используют методы линейной алгебры для анализа подпространств данных
системы (прошлых входов/выходов и будущих выходов),
чтобы непосредственно оценить матрицы системы $A$,$B$,$C$,$D$ и статистику шума.

Данный метод широко применяется для идентификации многомерных систем с
множеством входных и выходных сигналов, а также систем, где модель пространства
состояний является предпочтительной формой (например, регуляторов).

Метод является прямым и робастным к шуму, однако очень чувствителен к выбору
размерности матриц системы. Полученные данным методом модели не могут быть
применимы при использовании вне области определения, в которой она
разрабатывалась. Кроме того, построение моделей требуют выбора порядка модели,
что может быть неочевидно из данных.

\subsubsection{Частотные методы}

Частотные методы анализируют связь между входом и выходом в частотной области. Основой метода является оценка частотной характеристики системы, которая показывает, как система изменяет амплитуду и фазу синусоидального входного сигнала на разных частотах. Построение характеристики может быть оценена, например, с помощью преобразования Фурье входных и выходных сигналов.
Полезны для понимания поведения системы на конкретных частотах, выявления резонансов, определения полосы пропускания. Могут использоваться для идентификации передаточных функций линейных систем, где параметры полиномов числителя и знаменателя оцениваются путем подбора кривой под экспериментальную частотную характеристику.

Метод позволяют сосредоточиться на важных частотных диапазонах. Кроме того, он относительно нечувствительен к некоторым типам шума при правильном усреднении. Однако, основным недостатком метода при всех его преимуещствах является строгая применимость только к линейным системам.

\subsection{Нелинейные методы}

В основе классических методов идентификации нелинейных систем, как правило, лежит выбор специфической структуры нелинейности или разложение нелинейности по базисным функциям. К таковым методам относятся

\begin{itemize}
  \item Модели Уинера и Гаммерштейна;
  \item Модели NARX/NARMAX с базисными функциями.
\end{itemize}

\subsubsection{Модели Уинера и Гаммерштейна}

Данные модели представляют систему как комбинацию линейной динамической части и
статической нелинейности. Используются для систем, где предполагается блочное
разделение нелинейных элементов. Метод описывает две модели, которыми могут
быть описаны системы

\paragraph{Модель Гаммерштейна} характеризуется наличием статической
нелинейности на входе, за которой следует линейная динамическая система.

\begin{equation}
  y(t)=G(q)F(u(t))+e(t)
  \label{eq:gamer}
\end{equation}

В выражении \ref{eq:gamer} $G(q)$ - линейная передаточная функция, $F(z)$ -
статическая нелинейная функция. 

\paragraph{Модель Уинера} характеризуется линейной динамической системой, за которой следует статическая нелиненейность на выходе.

\begin{equation}
  y(t)=F(G(q)u(t))+e(t)
  \label{eq:uiner}
\end{equation}

В выражении \ref{eq:uiner} $G(q)$ - линейная передаточная функция, $F(z)$ -
статическая нелинейная функция. 

Идентификация часто выполняется в два этапа, поочередено оценивая линейную и
нелинейную части, или с помощью итерационных оптимизационных процедур.
Статическая нелинейность $F(z)$ может быть представлена полиномом, 
кусочно-линейной функцией или другой параметрической формой.

Несмотря нга относительно простую структуру, которую можно связать с
физическими блоками системы и возможности сведения задачи к МНК для некоторых
задач, метод ограничен спецификой блочной структуры и не подходят для систем с
более сложной нелинейной динамикой. Кроме того, идентификация может быть
вычислительно сложной и чувствительной к начальным условиям

\subsubsection{Модели NARX с базисными функциями}

Метод является расширением метода МНК для ARX моделей. Нелинейная модель может быть описана

\begin{equation}
  y(t)=f(y(t-1),\dots,y(t-n_a),u(t-n_k),\dots,u(t-n_b-n_k))+e(t)
  \label{eq:narx}
\end{equation}


Данные методы более гибкие, чем просто линейные модели. Кроме того метод может
использоваться для аппроксимации более широкого класса нелинейных
систем, чем модели Уинера/Гаммерштейна, при условии правильного выбора базисных
функций и их комбинаций. 

Главный недостаток — необходимость выбора структуры нелинейности, в частности
базисные функции и порядок полинома. 

\section{Интеллектуальные методы}

Традиционные методы динамической идентификации, особенно линейные модели,
зачастую имеют малую точность в задачах с точным представлением сложных,
нелинейных промышленных процессов, обусловленных также наличием внешних шумов
или иных внешних воздействий, способных изменить динамику модели. Кроме того, 
данные методы не могут предоставить возможность построения предсказательных 
моделей, которые не будут требовать больших трудозатрат 
\cite{bib:ident:neural:transformers}. Также, классическим методам характерны 
трудности с идентификацией сложных, произвольных по размеру нелинейных 
динамических систем. Классические нелинейные методы требуют априорного выбора 
специфической нелинейной структуры, что часто невозможно без глубоких знаний 
о системе. 

Кроме того, классические методы очень чувствительны к выбору классу моделей и 
настройкам гиперпараметров этих моделей. Также, имеется проблема 
чувствительности к шуму и выбросам также приводит к неправильным решениям. 

В частности, наиболее явным недостатком классических методов является невозможность 
масштабирования имеющихся решений без необходимости полного пересчета решения. 

Решением данных проблем являются интеллектуальные методы, основанные на методах 
машинного обучения. 


\subsection{Алгоритмы машинного обучения}  

Алгоритмы машинного обучения нашли распространение только в задачах оптимизации
моделей идентификации . В частности, к данным алгоритмам относятся следующие:

\begin{itemize}
  \item SVM-метод;
  \item Генеративные методы;
  \item Ансамблевые методы.
\end{itemize}

SVM-методы зачастую используются только при работе с линейными моделями. 

Так, например, генетические алгоритмы используются для поиска оптимальных
параметров или даже структуры динамических моделей. 

Ансамблевые модели объединяют прогнозы нескольких отдельных моделей для
повышения общей точности и устойчивости процесса идентификации.

\subsection{Нейронные сети}

Нейронные сети широко применяются при идентификации динамических систем в
качестве непараметрических методов \cite{bib:ident:modelling}. Модели, 
построенные на базе нейронных сетей основываются в основном только на 
данных о работе системы. 

Использование нейронных сетей обусловлено несколькими факторами:

\begin{itemize}
  \item Универсальной аппроксимация;
  \item Работа с временными рядами;
  \item Адаптируемость и масштабируемость;
  \item Робастность к шумам;
  \item Автоматическое выявление закономерностей из данных;
  \item Описания нелинейностей любой размерности;
  \item Обработка мультиразмерных систем.
\end{itemize}

\subsubsection{Универсальная аппроксимация}
Одним из ключевых преимуществ является способность универсальной аппроксимации
функций любой сложности и нелинейности. В соответствии с этим нейронная сеть
может аппроксимировать любую непрерывную функцию с заданной точностью, при
условии наличия достаточной глубины сети и её количества параметров.

\subsubsection{Работа с временными рядами}

Многие реальные системы имеют динамическое поведение. Нейронные сети, особенно
такие архитектуры, как рекуррентные нейронные сети (RNN), сети с долгосрочной-
краткосрочной памятью (LSTM) и их различные вариации (например, GRU), разработаны
специально для работы с временными зависимостями \cite{bib:ident:neural:fundumentals}.

В отличие от традиционных методов, где требуется строго заданная структура
подсчёта задержек, нейронные сети автоматически извлекают важную информацию из
временных данных, что делает их незаменимыми для нелинейных объектов с
запаздыванием или высокой инерцией.

\subsubsection{Адаптируемость и масштабируемость}

Одной из отличительных черт методов нейронных сетей по сравнению с
классическими методам является свойство дообучаемости \cite{bib:ident:modelling:complex}. 
Предобученная модель может быть дообучена на базе новых данных без необходимости полного
пересоздания модели, в отличии от традиционных методов, требующих полного
пересчета.

\subsubsection{Робастность у шумам}

Нейронные сети способны работать даже в условиях шумных данных, обучаясь
выделять ключевые структуры из зашумленных данных. Они эффективно компенсируют
несовершенства измерений и нечёткую природу сигналов, что важно для сложных
систем.

\subsubsection{Выявление закономерностей в данных}

Одна из сложностей в классической идентификации систем состоит в
предварительном выделении признаков и зависмостей между ними. Нейронные сети
автоматически извлекают набор релевантных признаков из исходных данных
благодаря многоуровневой обработке. Особенно это выражено в архитектурах
глубокого обучения.

\subsubsection{Описание нелинейностей}

Цифровые двойники на базе нейронных сетей способным описывать системы,
обусловленные нейлинейностями любого рода. В связи с этим, они могут быть
безусловно применены для идентификации систем любой природы.

\subsubsection{Обработка мультиразмерных данных}

Нейронные сети могут быть обучены на очень больших наборах
исторических данных. Классические же методы либо теряют точность при
разрастании модели, либо становятся высоко затратными при моделировании.
Нейронные сети балансируют между возможностями аппроксимации и вычислительной
эффективностью.


Все перечисленные преимущества привели к тому, что
нейронные сети стали применять для моделирования
систем и процессов с использованием моделей в виде
некоторого <<черного ящика>>, определяющего
поведение всей системы целиком. Однако,
идентификация системы в виде единого “черного ящика”
в случае наличия дополнительных данных о внутренних
сигналах может быть неэффективна в связи с упущением
данных о внутренней структуре и подсистемах,
входящих в систему \cite{bib:ident}. 

Таким образом, присущая нейронным сетям адаптивность и способность к нелинейной
аппроксимации дают значительные преимущества перед традиционными методами для
динамической идентификации сложных промышленных систем, которые часто
демонстрируют сложные и изменяющиеся во времени характеристики.


